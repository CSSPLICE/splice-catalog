<!DOCTYPE html>
<html>
<%
    const truncateWords = (s, n = 20) => {
        if (!s) return "";
        const words = String(s).trim().split(/\s+/);
        return words.length <= n ? s : words.slice(0, n).join(' ') + '...';
    };
%>
<%- include('../partials/head') -%>
<style>
    .table {
        table-layout: fixed;
        width: 100%;
    }

    .table th:nth-child(3),
    .table td:nth-child(3) {
        width: 30%;
        max-width: 200px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .table th:nth-child(4),
    .table td:nth-child(4) {
        width: 10%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .table th:nth-child(5),
    .table td:nth-child(5) {
        width: 8%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .table td {
        vertical-align: middle;
    }
</style>
<%- include('../partials/header') -%>
<body>
    <div class="container mt-5">
        <h2>Dataset Catalog</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Platform/Publisher</th>
                    <th>Description</th>
                    <th>URL</th>
                    <th>Year</th>
                    <th>Data Formats</th>
                </tr>
            </thead>
            <tbody>
                <% datasets.forEach(function(dataset) { %>
                <tr>
                    <td><%= dataset.title %></td>
                    <td><%= dataset.publisher %></td>
                    <td><span class="short-description" data-description="<%= dataset.description || '' %>" style="cursor: pointer;">
                            <%- truncateWords(dataset.description, 20) %>
                        </span></td>
                    <td><a href="<%= dataset.resource_url %>" target="_blank">Link</a></td>
                    <td><%= dataset.data_collection_end_date %></td>
                    <td><%= dataset.data_standard %></td>
                </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
    <div class="container">
	<p>This dataset catalog is a compilation of open-source datasets in computing education, curated by the
"Where is the data? Finding and reusing datasets in computing education" CompEd 23' working group. The working group aims to make
research data more accessible and encourage open data practices in the computing education research (CER) community. For more information,
please refer to the working group's paper: Kiesler, Natalie, John Impagliazzo, Katarzyna Biernacka, Amanpreet Kapoor, Zain Kazmi,
Sujeeth Goud Ramagoni, Aamod Sane, Keith Tran, Shubbhi Taneja, and Zihan Wu. "Where's the Data? Exploring Datasets in Computing
Education." In Proceedings of the ACM Conference on Global Computing Education Vol 2, pp. 209-210. 2023.</p>
    </div>

    <!-- Description Modal -->
    <div id="descriptionModal" class="modal" style="display: none; position: fixed; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5);">
      <div class="modal-content" style="background-color: white; margin: 10% auto; padding: 20px; border-radius: 5px; width: 50%; position: relative;">
        <span class="close" onclick="closeModal()" style="cursor: pointer; position: absolute; top: 10px; right: 15px; font-size: 24px;">&times;</span>
        <p id="fullDescription" style="margin-top: 30px;"></p>
      </div>
    </div>

    <!-- Bootstrap JS bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("descriptionModal");
        const modalText = document.getElementById("fullDescription");

        document.querySelectorAll(".short-description").forEach((el) => {
          el.addEventListener("click", () => {
            modalText.textContent = el.getAttribute("data-description") || "Detailed Description.";
            modal.style.display = "block";
          });
        });

        document.querySelector(".close").addEventListener("click", () => {
          modal.style.display = "none";
        });
      });
    </script>
</body>
<%- include('../partials/footer') -%>
</html>
